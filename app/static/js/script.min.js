function showSimilarCarsForm() {
    $('#form1').trigger('reset'); $("#similarcars-form").removeClass("d-none"); $("#similarcars-form-2").addClass("d-none"); $("#similarcar-result").addClass("d-none");
    
}
function hideSimilarCarsForm() {
    $("#similarcars-form").addClass("d-none");
}
function showSimilarCarsForm_2() {
    $('#form2').trigger('reset');
    var a =
        '<svg class="bi bi-star" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" style="color: rgb(254,209,54);"><path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"></path></svg>';
    $("#companyrating-btn").html(a.repeat(5));
    $("#companyRating-value").val();
    $("#consumerrating-btn").html(a.repeat(5));
    $("#consumerRating-value").val();
    $("#similarcars-form-2").removeClass("d-none");
    $("#similarcars-form").addClass("d-none");
    $("#similarcar-result-1").addClass("d-none");
}
function hideSimilarCarsForm_2() {
    $("#similarcars-form-2").addClass("d-none");
}
function showSimilarCarsResult() {
    var search_bar = $('#search_bar').val();
    if (search_bar == "") {
        return false;
    }
    $('#similar_car_result_main_div').html("");
    var url = "/content-based-search";
    $.ajax({
        url: url,
        data: { keyword: search_bar },
        dateType: "json",
        type: "POST",
        beforeSend: function () {
            $("#similarcar-result").addClass("d-none");
            $("#similarcar-result-loader").removeClass("d-none");
        },
        success: function (data) {
            // console.info(data['data'])
            if(data['Status']==200){
                data['data'].forEach(similarcars_divs);
            }
            else{
                var html='<div class="col">                <h6 class="text-capitalize text-center">Sorry, No Cars Found!!</h6>            </div>';
                $('#similar_car_result_main_div').html(html);
            }
            
            setTimeout(function () {
                $("#similarcar-result-loader").addClass("d-none");
                $("#similarcar-result").removeClass("d-none");
            }, 2e3);
            // $('#search_bar').val("");
            
        }


    });
}

function similarcars_divs(item,index)
{
    var html='<div class="col-xl-4" style="padding-bottom: 10px;">    <div class="card">        <div class="card-body">            <h4 class="card-title" style="font-size: 18px;">'+
    item['brand name']+' '+item['submodel']+' '+item['car name'].replace("_"," ")+' '+item['engine'].replace("_"," ")+'</h4>            <h6 class="text-muted card-subtitle mb-2"><i class="fas fa-rupee-sign"></i>&nbsp;'+Math.round(item['msrp'],2)+"Lakhs"+'</h6><img class="img-fluid" src="'+item['photo']+'" loading="lazy">        </div>     </div> </div>';
    $('#similar_car_result_main_div').append(html);
}
function similarcars_divs_item(item,index)
{
    var html='<div class="col-xl-4" style="padding-bottom: 10px;">    <div class="card">        <div class="card-body">            <h4 class="card-title" style="font-size: 18px;">'+
    item['brand name']+' '+item['submodel']+' '+item['car name'].replace("_"," ")+' '+item['engine'].replace("_"," ")+'</h4>            <h6 class="text-muted card-subtitle mb-2"><i class="fas fa-rupee-sign"></i>&nbsp;'+Math.round(item['msrp'],2)+' '+"Lakhs"+', '+'HM/CM :' + item['hm'] + '/'+ item['cm'] + ', ' + ' consumer/company:'+ item['conrat'] + '/' + item['comrat'] + '</h6><img class="img-fluid" src="'+item['photo']+'" loading="lazy">        </div>     </div> </div>';
    $('#similar_car_result_main_div_item').append(html);
}
function showSimilarCarsResult_2() {
    var highway_mileage=$("#highway_mileage").val();
    var city_mileage=$("#city_mileage").val();
    var price=$("#price").val();
    var companyRatingvalue=$("#companyRating-value").val();
    var consumerRatingvalue=$("#consumerRating-value").val();
    if (highway_mileage=="") 
    {
        highway_mileage=29.12;
    }
    if(city_mileage=="" )
    {
        city_mileage=21.61;
    } 
    if ( price=="" )
    {
        price=31.38;
    }
    if(companyRatingvalue=="" )
    {
        companyRatingvalue=4.03;
    }
    if(consumerRatingvalue=="")
    {
        consumerRatingvalue=4.2;
    }
    $('#similar_car_result_main_div_item').html("");
    var url = "/item-based-search";
    $.ajax({
        url: url,
        data: { highway_mileage: highway_mileage,city_mileage:city_mileage, price:price,companyRatingvalue:companyRatingvalue,consumerRatingvalue:consumerRatingvalue},
        dateType: "json",
        type: "POST",
        beforeSend: function () {
            $("#similarcar-result-1").addClass("d-none");
            $("#similarcar-result-loader-1").removeClass("d-none");
        },
        success: function (data) {
            // console.info(data['data'])
            if(data['Status']==200){
                data['data'].forEach(similarcars_divs_item);
            }
            else{
                var html='<div class="col">                <h6 class="text-capitalize text-center">Sorry, No Cars Found!!</h6>            </div>';
                $('#similar_car_result_main_div_item').html(html);
            }
            
            setTimeout(function () {
                $("#similarcar-result-loader-1").addClass("d-none"); $("#similarcar-result-1").removeClass("d-none");
            }, 500);
            // $('#search_bar').val("");
            
        }


    });



   
}
function selectCompanyRating(a, r) {
    var s = $(a).html();
    $("#companyrating-btn").html(s); $("#companyRating-value").val(r);
}
function selectConsumerRating(a, r) {
    console.log(r);
    var s = $(a).html();
    $("#consumerrating-btn").html(s); $("#consumerRating-value").val(r);
}
$(document).ready(function () {
    $("[data-bss-tooltip]").tooltip();
});


function autocompleteMatch(input) {
    if (input == '') {
        return [];
    }
    var reg = new RegExp(input)
    var search_terms = document.getElementsByName('search_terms[]');
    var array = []
    for (var i = 0; i < search_terms.length; i++) {
        array[i] = search_terms[i].value;
    }
    //   console.log(array)
    return array.filter(function (term) {
        if (term.match(reg)) {
            return term;
        }
    });
}

function setvalue(element) {
    $('#result').html("");
    var value = $(element).html();
    $('#search_bar').val(value);
}
function showResults(val) {
    console.info(val);
    res = document.getElementById("result");
    res.innerHTML = '';
    let list = '';
    let terms = autocompleteMatch(val);
    for (i = 0; i < terms.length; i++) {
        list += '<li onclick="setvalue(this)">' + terms[i] + '</li>';
    }
    res.innerHTML = '<ul>' + list + '</ul>';
}

